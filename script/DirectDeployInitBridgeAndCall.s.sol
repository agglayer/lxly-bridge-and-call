pragma solidity 0.8.20;

import "forge-std/Script.sol";

contract DirectDeployInitBridgeAndCall is Script {
    address create2Deployer = 0x4e59b44847b379578588920cA78FbF26c0B4956C;

    address expectedProxy = 0xC34f256650CCa877b098f168305850b191e68B58;
    address expectedImpl = 0x8DCc9123dfa96e522fD0b4E670D21bce86680253;

    function run() external {
        // Check prerequisites
        require(create2Deployer.code.length != 0, "No create2 deployer.");

        vm.startBroadcast(vm.envUint("DEPLOYER_PRIVATE_KEY"));
        
        if (expectedImpl.code.length == 0) {
            (bool _successImpl, bytes memory _resImpl) = create2Deployer.call(
                hex"0000000000000000000000000000000000000000000000000000000000000001608060405234801561000f575f80fd5b5061001861001d565b6100da565b5f54610100900460ff16156100885760405162461bcd60e51b815260206004820152602760248201527f496e697469616c697a61626c653a20636f6e747261637420697320696e697469604482015266616c697a696e6760c81b606482015260840160405180910390fd5b5f5460ff90811610156100d8575f805460ff191660ff9081179091556040519081527f7f26b83ff96e1f2b6a682f133852f6798a09c465da95921460cefb38474024989060200160405180910390a15b565b61248a806100e75f395ff3fe60806040526004361062000043575f3560e01c80631806b5f21462000047578063c4d66de81462000060578063ddcf54881462000084578063e78cea92146200009b575b5f80fd5b6200005e6200005836600462001546565b620000dd565b005b3480156200006c575f80fd5b506200005e6200007e366004620015af565b6200026d565b6200005e62000095366004620015e2565b620003c5565b348015620000a7575f80fd5b505f54620000c1906201000090046001600160a01b031681565b6040516001600160a01b03909116815260200160405180910390f35b5f546201000090046001600160a01b031633146200010e57604051636ec8e0c160e11b815260040160405180910390fd5b6001600160a01b03841630146200013857604051630e9082bd60e01b815260040160405180910390fd5b5f80808080806200014c87890189620016a9565b5f546040516366230b1960e11b8152969c50949a50929850909650945092506001600160a01b0362010000909104169063cc46163290620001a59089908d9060040163ffffffff92831681529116602082015260400190565b602060405180830381865afa158015620001c1573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190620001e79190620017b7565b6200020557604051630baa41dd60e31b815260040160405180910390fd5b855f1b5f60029054906101000a90046001600160a01b031684848888866040516200023090620014c6565b620002419695949392919062001826565b8190604051809103905ff59050801580156200025f573d5f803e3d5ffd5b505050505050505050505050565b5f54610100900460ff16158080156200028c57505f54600160ff909116105b80620002a75750303b158015620002a757505f5460ff166001145b620003105760405162461bcd60e51b815260206004820152602e60248201527f496e697469616c697a61626c653a20636f6e747261637420697320616c72656160448201526d191e481a5b9a5d1a585b1a5e995960921b60648201526084015b60405180910390fd5b5f805460ff19166001179055801562000332575f805461ff0019166101001790555b6001600160a01b0382166200035a5760405163e6c4247b60e01b815260040160405180910390fd5b5f805462010000600160b01b031916620100006001600160a01b038516021790558015620003c1575f805461ff0019169055604051600181527f7f26b83ff96e1f2b6a682f133852f6798a09c465da95921460cefb38474024989060200160405180910390a15b5050565b5f8060029054906101000a90046001600160a01b03166001600160a01b0316632dfdf0b56040518163ffffffff1660e01b8152600401602060405180830381865afa15801562000417573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906200043d91906200187b565b6200044a906001620018a7565b90506001600160a01b03891615801590620004ec57505f60029054906101000a90046001600160a01b03166001600160a01b0316634b2f336d6040518163ffffffff1660e01b8152600401602060405180830381865afa158015620004b1573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190620004d79190620018c3565b6001600160a01b0316896001600160a01b0316145b156200060b576040516370a0823160e01b81523060048201525f906001600160a01b038b16906370a0823190602401602060405180830381865afa15801562000537573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906200055d91906200187b565b9050620005766001600160a01b038b1633308c62000c1a565b6040516370a0823160e01b81523060048201525f906001600160a01b038c16906370a0823190602401602060405180830381865afa158015620005bb573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190620005e191906200187b565b9050620005ef8282620018e1565b9950620006038b8b8b8b8b8b8b8a62000c7c565b505062000766565b6001600160a01b03891662000652578734146200063b5760405163b89240f560e01b815260040160405180910390fd5b6200064c8888888888888762000dbe565b62000766565b6040516370a0823160e01b81523060048201525f906001600160a01b038b16906370a0823190602401602060405180830381865afa15801562000697573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190620006bd91906200187b565b9050620006d66001600160a01b038b1633308c62000c1a565b6040516370a0823160e01b81523060048201525f906001600160a01b038c16906370a0823190602401602060405180830381865afa1580156200071b573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906200074191906200187b565b90506200074f8282620018e1565b9950620007638b8b8b8b8b8b8b8a62000f49565b50505b5f60029054906101000a90046001600160a01b03166001600160a01b0316632dfdf0b56040518163ffffffff1660e01b8152600401602060405180830381865afa158015620007b7573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190620007dd91906200187b565b8114620007fd576040516336cbe6ed60e11b815260040160405180910390fd5b60606001600160a01b038a16158015906200089f57505f60029054906101000a90046001600160a01b03166001600160a01b0316634b2f336d6040518163ffffffff1660e01b8152600401602060405180830381865afa15801562000864573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906200088a9190620018c3565b6001600160a01b03168a6001600160a01b0316145b1562000951578187875f60029054906101000a90046001600160a01b03166001600160a01b031663bab161bf6040518163ffffffff1660e01b8152600401602060405180830381865afa158015620008f9573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906200091f9190620018f7565b5f89896040516020016200093a979695949392919062001915565b604051602081830303815290604052905062000ba3565b6001600160a01b038a1662000a6b578187875f60029054906101000a90046001600160a01b03166001600160a01b0316633cbc795b6040518163ffffffff1660e01b8152600401602060405180830381865afa158015620009b4573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190620009da9190620018f7565b5f60029054906101000a90046001600160a01b03166001600160a01b0316633c351e106040518163ffffffff1660e01b8152600401602060405180830381865afa15801562000a2b573d5f803e3d5ffd5b505050506040513d601f19601f8201168201806040525081019062000a519190620018c3565b89896040516020016200093a979695949392919062001915565b5f805460405163318aee3d60e01b81526001600160a01b038d811660048301528392620100009004169063318aee3d906024016040805180830381865afa15801562000ab9573d5f803e3d5ffd5b505050506040513d601f19601f8201168201806040525081019062000adf91906200197c565b90925090506001600160a01b03811662000b70575f60029054906101000a90046001600160a01b03166001600160a01b031663bab161bf6040518163ffffffff1660e01b8152600401602060405180830381865afa15801562000b44573d5f803e3d5ffd5b505050506040513d601f19601f8201168201806040525081019062000b6a9190620018f7565b91508b90505b83898984848b8b60405160200162000b8f979695949392919062001915565b604051602081830303815290604052925050505b5f54604051630481fe6f60e31b8152620100009091046001600160a01b03169063240ff3789062000bdf908b90309088908790600401620019b9565b5f604051808303815f87803b15801562000bf7575f80fd5b505af115801562000c0a573d5f803e3d5ffd5b5050505050505050505050505050565b604080516001600160a01b0385811660248301528416604482015260648082018490528251808303909101815260849091019091526020810180516001600160e01b03166323b872dd60e01b17905262000c7690859062001163565b50505050565b5f62000d38825f60029054906101000a90046001600160a01b03166001600160a01b031663bab161bf6040518163ffffffff1660e01b8152600401602060405180830381865afa15801562000cd3573d5f803e3d5ffd5b505050506040513d601f19601f8201168201806040525081019062000cf99190620018f7565b5f898989898080601f0160208091040260200160405190810160405280939291908181526020018383808284375f920191909152506200124292505050565b90505f60029054906101000a90046001600160a01b03166001600160a01b031663cd58657988838b8d5f6040518663ffffffff1660e01b815260040162000d84959493929190620019fc565b5f604051808303815f87803b15801562000d9c575f80fd5b505af115801562000daf573d5f803e3d5ffd5b50505050505050505050505050565b5f62000ef0825f60029054906101000a90046001600160a01b03166001600160a01b0316633cbc795b6040518163ffffffff1660e01b8152600401602060405180830381865afa15801562000e15573d5f803e3d5ffd5b505050506040513d601f19601f8201168201806040525081019062000e3b9190620018f7565b5f60029054906101000a90046001600160a01b03166001600160a01b0316633c351e106040518163ffffffff1660e01b8152600401602060405180830381865afa15801562000e8c573d5f803e3d5ffd5b505050506040513d601f19601f8201168201806040525081019062000eb29190620018c3565b898989898080601f0160208091040260200160405190810160405280939291908181526020018383808284375f920191909152506200124292505050565b5f805460405163cd58657960e01b81529293506201000090046001600160a01b03169163cd586579918b9162000f31918c91879185918190600401620019fc565b5f604051808303818588803b15801562000d9c575f80fd5b5f805460405163318aee3d60e01b81526001600160a01b038b8116600483015283928392620100009091049091169063318aee3d906024016040805180830381865afa15801562000f9c573d5f803e3d5ffd5b505050506040513d601f19601f8201168201806040525081019062000fc291906200197c565b90925090506001600160a01b038116620010d0575f60029054906101000a90046001600160a01b03166001600160a01b031663bab161bf6040518163ffffffff1660e01b8152600401602060405180830381865afa15801562001027573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906200104d9190620018f7565b5f5460405163095ea7b360e01b81526001600160a01b036201000090920482166004820152602481018d90529193508c925082169063095ea7b3906044016020604051808303815f875af1158015620010a8573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190620010ce9190620017b7565b505b620011158483838b8b8b8b8080601f0160208091040260200160405190810160405280939291908181526020018383808284375f920191909152506200124292505050565b925050505f60029054906101000a90046001600160a01b03166001600160a01b031663cd58657988838b8d5f6040518663ffffffff1660e01b815260040162000d84959493929190620019fc565b5f620011b9826040518060400160405280602081526020017f5361666545524332303a206c6f772d6c6576656c2063616c6c206661696c6564815250856001600160a01b0316620013299092919063ffffffff16565b905080515f1480620011dc575080806020019051810190620011dc9190620017b7565b6200123d5760405162461bcd60e51b815260206004820152602a60248201527f5361666545524332303a204552433230206f7065726174696f6e20646964206e6044820152691bdd081cdd58d8d9595960b21b606482015260840162000307565b505050565b5f80604051806020016200125690620014c6565b818103601f199081018352601f9091011660408190525f546200129791620100009091046001600160a01b0316908a908a908a908a908a9060200162001826565b60408051601f1981840301815290829052620012b7929160200162001a42565b60408051808303601f1901815282825280516020918201206001600160f81b0319828501523060601b6bffffffffffffffffffffffff19166021850152603584019b909b5260558084019b909b528151808403909b018b52607590920190528851980197909720979650505050505050565b60606200133984845f8562001341565b949350505050565b606082471015620013a45760405162461bcd60e51b815260206004820152602660248201527f416464726573733a20696e73756666696369656e742062616c616e636520666f6044820152651c8818d85b1b60d21b606482015260840162000307565b5f80866001600160a01b03168587604051620013c1919062001a74565b5f6040518083038185875af1925050503d805f8114620013fd576040519150601f19603f3d011682016040523d82523d5f602084013e62001402565b606091505b5091509150620014158783838762001420565b979650505050505050565b60608315620014935782515f036200148b576001600160a01b0385163b6200148b5760405162461bcd60e51b815260206004820152601d60248201527f416464726573733a2063616c6c20746f206e6f6e2d636f6e7472616374000000604482015260640162000307565b508162001339565b620013398383815115620014aa5781518083602001fd5b8060405162461bcd60e51b815260040162000307919062001a91565b6109af8062001aa683390190565b6001600160a01b0381168114620014e9575f80fd5b50565b63ffffffff81168114620014e9575f80fd5b5f8083601f8401126200150f575f80fd5b50813567ffffffffffffffff81111562001527575f80fd5b6020830191508360208285010111156200153f575f80fd5b9250929050565b5f805f80606085870312156200155a575f80fd5b84356200156781620014d4565b935060208501356200157981620014ec565b9250604085013567ffffffffffffffff81111562001595575f80fd5b620015a387828801620014fe565b95989497509550505050565b5f60208284031215620015c0575f80fd5b8135620015cd81620014d4565b9392505050565b8015158114620014e9575f80fd5b5f805f805f805f8060e0898b031215620015fa575f80fd5b88356200160781620014d4565b97506020890135965060408901356200162081620014ec565b955060608901356200163281620014d4565b945060808901356200164481620014d4565b935060a089013567ffffffffffffffff81111562001660575f80fd5b6200166e8b828c01620014fe565b90945092505060c08901356200168481620015d4565b809150509295985092959890939650565b634e487b7160e01b5f52604160045260245ffd5b5f805f805f8060c08789031215620016bf575f80fd5b863595506020870135620016d381620014d4565b94506040870135620016e581620014d4565b93506060870135620016f781620014ec565b925060808701356200170981620014d4565b915060a087013567ffffffffffffffff8082111562001726575f80fd5b818901915089601f8301126200173a575f80fd5b8135818111156200174f576200174f62001695565b604051601f8201601f19908116603f011681019083821181831017156200177a576200177a62001695565b816040528281528c602084870101111562001793575f80fd5b826020860160208301375f6020848301015280955050505050509295509295509295565b5f60208284031215620017c8575f80fd5b8151620015cd81620015d4565b5f5b83811015620017f1578181015183820152602001620017d7565b50505f910152565b5f815180845262001812816020860160208601620017d5565b601f01601f19169290920160200192915050565b6001600160a01b03878116825263ffffffff87166020830152858116604083015284811660608301528316608082015260c060a082018190525f906200186f90830184620017f9565b98975050505050505050565b5f602082840312156200188c575f80fd5b5051919050565b634e487b7160e01b5f52601160045260245ffd5b80820180821115620018bd57620018bd62001893565b92915050565b5f60208284031215620018d4575f80fd5b8151620015cd81620014d4565b81810381811115620018bd57620018bd62001893565b5f6020828403121562001908575f80fd5b8151620015cd81620014ec565b8781526001600160a01b038781166020830152868116604083015263ffffffff861660608301528416608082015260c060a0820181905281018290525f828460e08401375f60e0848401015260e0601f19601f850116830101905098975050505050505050565b5f80604083850312156200198e575f80fd5b82516200199b81620014ec565b6020840151909250620019ae81620014d4565b809150509250929050565b63ffffffff851681526001600160a01b038416602082015282151560408201526080606082018190525f90620019f290830184620017f9565b9695505050505050565b63ffffffff9590951685526001600160a01b039384166020860152604085019290925290911660608301521515608082015260c060a082018190525f9082015260e00190565b5f835162001a55818460208801620017d5565b83519083019062001a6b818360208801620017d5565b01949350505050565b5f825162001a87818460208701620017d5565b9190910192915050565b602081525f620015cd6020830184620017f956fe60806040526040516109af3803806109af833981016040819052610022916107ec565b855f6001600160a01b03861661009957816001600160a01b0316634b2f336d6040518163ffffffff1660e01b8152600401602060405180830381865afa15801561006e573d5f803e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061009291906108f0565b90506102b5565b816001600160a01b0316633c351e106040518163ffffffff1660e01b8152600401602060405180830381865afa1580156100d5573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906100f991906108f0565b6001600160a01b0316866001600160a01b03161480156101835750816001600160a01b0316633cbc795b6040518163ffffffff1660e01b8152600401602060405180830381865afa158015610150573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906101749190610912565b63ffffffff168763ffffffff16145b6102b557816001600160a01b031663bab161bf6040518163ffffffff1660e01b8152600401602060405180830381865afa1580156101c3573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906101e79190610912565b63ffffffff168763ffffffff16036102005750846102b5565b6040516001600160e01b031960e089901b1660208201526001600160601b0319606088901b1660248201526001600160a01b038316906381b1c17490603801604051602081830303815290604052805190602001206040518263ffffffff1660e01b815260040161027391815260200190565b602060405180830381865afa15801561028e573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906102b291906108f0565b90505b6001600160a01b03811661037a575f4790505f866001600160a01b031682866040516102e1919061092b565b5f6040518083038185875af1925050503d805f811461031b576040519150601f19603f3d011682016040523d82523d5f602084013e610320565b606091505b5050905080610378576040516001600160a01b0387169083905f81818185875af1925050503d805f811461036f576040519150601f19603f3d011682016040523d82523d5f602084013e610374565b606091505b5050505b005b6040516370a0823160e01b81523060048201525f906001600160a01b038316906370a0823190602401602060405180830381865afa1580156103be573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906103e29190610946565b60405163095ea7b360e01b81526001600160a01b038881166004830152602482018390529192509083169063095ea7b3906044016020604051808303815f875af1158015610432573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190610456919061095d565b505f866001600160a01b031685604051610470919061092b565b5f604051808303815f865af19150503d805f81146104a9576040519150601f19603f3d011682016040523d82523d5f602084013e6104ae565b606091505b5050905080610378576103786001600160a01b03841687846040516001600160a01b03831660248201526044810182905261052990849063a9059cbb60e01b9060640160408051808303601f190181529190526020810180516001600160e01b0319939093166001600160e01b039384161790529061052e16565b505050565b6040805180820190915260208082527f5361666545524332303a206c6f772d6c6576656c2063616c6c206661696c6564908201525f9061057a906001600160a01b0385169084906105fc565b8051909150156105295780806020019051810190610598919061095d565b6105295760405162461bcd60e51b815260206004820152602a60248201527f5361666545524332303a204552433230206f7065726174696f6e20646964206e6044820152691bdd081cdd58d8d9595960b21b60648201526084015b60405180910390fd5b606061060a84845f85610612565b949350505050565b6060824710156106735760405162461bcd60e51b815260206004820152602660248201527f416464726573733a20696e73756666696369656e742062616c616e636520666f6044820152651c8818d85b1b60d21b60648201526084016105f3565b5f80866001600160a01b0316858760405161068e919061092b565b5f6040518083038185875af1925050503d805f81146106c8576040519150601f19603f3d011682016040523d82523d5f602084013e6106cd565b606091505b5090925090506106df878383876106ea565b979650505050505050565b606083156107585782515f03610751576001600160a01b0385163b6107515760405162461bcd60e51b815260206004820152601d60248201527f416464726573733a2063616c6c20746f206e6f6e2d636f6e747261637400000060448201526064016105f3565b508161060a565b61060a838381511561076d5781518083602001fd5b8060405162461bcd60e51b81526004016105f3919061097c565b6001600160a01b038116811461079b575f80fd5b50565b805163ffffffff811681146107b1575f80fd5b919050565b634e487b7160e01b5f52604160045260245ffd5b5f5b838110156107e45781810151838201526020016107cc565b50505f910152565b5f805f805f8060c08789031215610801575f80fd5b865161080c81610787565b955061081a6020880161079e565b9450604087015161082a81610787565b606088015190945061083b81610787565b608088015190935061084c81610787565b60a08801519092506001600160401b0380821115610868575f80fd5b818901915089601f83011261087b575f80fd5b81518181111561088d5761088d6107b6565b604051601f8201601f19908116603f011681019083821181831017156108b5576108b56107b6565b816040528281528c60208487010111156108cd575f80fd5b6108de8360208301602088016107ca565b80955050505050509295509295509295565b5f60208284031215610900575f80fd5b815161090b81610787565b9392505050565b5f60208284031215610922575f80fd5b61090b8261079e565b5f825161093c8184602087016107ca565b9190910192915050565b5f60208284031215610956575f80fd5b5051919050565b5f6020828403121561096d575f80fd5b8151801515811461090b575f80fd5b602081525f825180602084015261099a8160408501602087016107ca565b601f01601f1916919091016040019291505056fea264697066735822122066e7f2cf72af2972bca13d0b8e48d6ed9c795c40d9a444cd95f9ee74ef4a276b64736f6c63430008140033"
            );
            console.log("Implementation deployed!");
        } else {
            console.log("Implementation already deployed correctly!");
        }
        if (expectedProxy.code.length == 0) {
            (bool _successProxy, bytes memory _resProxy) = create2Deployer.call(
                hex"0000000000000000000000000000000000000000000000000000000000000001608060405234801562000010575f80fd5b5060405162000e0738038062000e07833981016040819052620000339162000428565b82828282816200004582825f6200005f565b506200005390508262000090565b50505050505062000553565b6200006a8362000101565b5f82511180620000775750805b156200008b5762000089838362000142565b505b505050565b7f7e644d79422f17c01e4894b5f4f588d331ebfa28653d42ae832dc59e38c9798f620000d15f8051602062000dc0833981519152546001600160a01b031690565b604080516001600160a01b03928316815291841660208301520160405180910390a1620000fe8162000171565b50565b6200010c816200020e565b6040516001600160a01b038216907fbc7cd75a20ee27fd9adebab32041f755214dbc6bffa90cc0225b39da2e5c2d3b905f90a250565b60606200016a838360405180606001604052806027815260200162000de060279139620002a5565b9392505050565b6001600160a01b038116620001dc5760405162461bcd60e51b815260206004820152602660248201527f455243313936373a206e65772061646d696e20697320746865207a65726f206160448201526564647265737360d01b60648201526084015b60405180910390fd5b805f8051602062000dc08339815191525b80546001600160a01b0319166001600160a01b039290921691909117905550565b6001600160a01b0381163b6200027d5760405162461bcd60e51b815260206004820152602d60248201527f455243313936373a206e657720696d706c656d656e746174696f6e206973206e60448201526c1bdd08184818dbdb9d1c9858dd609a1b6064820152608401620001d3565b807f360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc620001ed565b60605f80856001600160a01b031685604051620002c3919062000502565b5f60405180830381855af49150503d805f8114620002fd576040519150601f19603f3d011682016040523d82523d5f602084013e62000302565b606091505b509092509050620003168683838762000320565b9695505050505050565b60608315620003935782515f036200038b576001600160a01b0385163b6200038b5760405162461bcd60e51b815260206004820152601d60248201527f416464726573733a2063616c6c20746f206e6f6e2d636f6e74726163740000006044820152606401620001d3565b50816200039f565b6200039f8383620003a7565b949350505050565b815115620003b85781518083602001fd5b8060405162461bcd60e51b8152600401620001d391906200051f565b80516001600160a01b0381168114620003eb575f80fd5b919050565b634e487b7160e01b5f52604160045260245ffd5b5f5b838110156200042057818101518382015260200162000406565b50505f910152565b5f805f606084860312156200043b575f80fd5b6200044684620003d4565b92506200045660208501620003d4565b60408501519092506001600160401b038082111562000473575f80fd5b818601915086601f83011262000487575f80fd5b8151818111156200049c576200049c620003f0565b604051601f8201601f19908116603f01168101908382118183101715620004c757620004c7620003f0565b81604052828152896020848701011115620004e0575f80fd5b620004f383602083016020880162000404565b80955050505050509250925092565b5f82516200051581846020870162000404565b9190910192915050565b602081525f82518060208401526200053f81604085016020870162000404565b601f01601f19169190910160400192915050565b61085f80620005615f395ff3fe60806040523661001357610011610017565b005b6100115b61001f610168565b6001600160a01b0316330361015e5760606001600160e01b03195f35166364d3180d60e11b81016100595761005261019a565b9150610156565b63587086bd60e11b6001600160e01b0319821601610079576100526101ed565b63070d7c6960e41b6001600160e01b031982160161009957610052610231565b621eb96f60e61b6001600160e01b03198216016100b857610052610261565b63a39f25e560e01b6001600160e01b03198216016100d8576100526102a0565b60405162461bcd60e51b815260206004820152604260248201527f5472616e73706172656e745570677261646561626c6550726f78793a2061646d60448201527f696e2063616e6e6f742066616c6c6261636b20746f2070726f78792074617267606482015261195d60f21b608482015260a4015b60405180910390fd5b815160208301f35b6101666102b3565b565b5f7fb53127684a568b3173ae13b9f8a6016e243e63b6e8ee1178d6a717850b5d61035b546001600160a01b0316919050565b60606101a46102c3565b5f6101b23660048184610668565b8101906101bf91906106aa565b90506101da8160405180602001604052805f8152505f6102cd565b505060408051602081019091525f815290565b60605f806101fe3660048184610668565b81019061020b91906106d7565b9150915061021b828260016102cd565b60405180602001604052805f8152509250505090565b606061023b6102c3565b5f6102493660048184610668565b81019061025691906106aa565b90506101da816102f8565b606061026b6102c3565b5f610274610168565b604080516001600160a01b03831660208201529192500160405160208183030381529060405291505090565b60606102aa6102c3565b5f61027461034f565b6101666102be61034f565b61035d565b3415610166575f80fd5b6102d68361037b565b5f825111806102e25750805b156102f3576102f183836103ba565b505b505050565b7f7e644d79422f17c01e4894b5f4f588d331ebfa28653d42ae832dc59e38c9798f610321610168565b604080516001600160a01b03928316815291841660208301520160405180910390a161034c816103e6565b50565b5f61035861048f565b905090565b365f80375f80365f845af43d5f803e808015610377573d5ff35b3d5ffd5b610384816104b6565b6040516001600160a01b038216907fbc7cd75a20ee27fd9adebab32041f755214dbc6bffa90cc0225b39da2e5c2d3b905f90a250565b60606103df83836040518060600160405280602781526020016108036027913961054a565b9392505050565b6001600160a01b03811661044b5760405162461bcd60e51b815260206004820152602660248201527f455243313936373a206e65772061646d696e20697320746865207a65726f206160448201526564647265737360d01b606482015260840161014d565b807fb53127684a568b3173ae13b9f8a6016e243e63b6e8ee1178d6a717850b5d61035b80546001600160a01b0319166001600160a01b039290921691909117905550565b5f7f360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc61018b565b6001600160a01b0381163b6105235760405162461bcd60e51b815260206004820152602d60248201527f455243313936373a206e657720696d706c656d656e746174696f6e206973206e60448201526c1bdd08184818dbdb9d1c9858dd609a1b606482015260840161014d565b807f360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc61046e565b60605f80856001600160a01b03168560405161056691906107b5565b5f60405180830381855af49150503d805f811461059e576040519150601f19603f3d011682016040523d82523d5f602084013e6105a3565b606091505b50915091506105b4868383876105be565b9695505050505050565b6060831561062c5782515f03610625576001600160a01b0385163b6106255760405162461bcd60e51b815260206004820152601d60248201527f416464726573733a2063616c6c20746f206e6f6e2d636f6e7472616374000000604482015260640161014d565b5081610636565b610636838361063e565b949350505050565b81511561064e5781518083602001fd5b8060405162461bcd60e51b815260040161014d91906107d0565b5f8085851115610676575f80fd5b83861115610682575f80fd5b5050820193919092039150565b80356001600160a01b03811681146106a5575f80fd5b919050565b5f602082840312156106ba575f80fd5b6103df8261068f565b634e487b7160e01b5f52604160045260245ffd5b5f80604083850312156106e8575f80fd5b6106f18361068f565b9150602083013567ffffffffffffffff8082111561070d575f80fd5b818501915085601f830112610720575f80fd5b813581811115610732576107326106c3565b604051601f8201601f19908116603f0116810190838211818310171561075a5761075a6106c3565b81604052828152886020848701011115610772575f80fd5b826020860160208301375f6020848301015280955050505050509250929050565b5f5b838110156107ad578181015183820152602001610795565b50505f910152565b5f82516107c6818460208701610793565b9190910192915050565b602081525f82518060208401526107ee816040850160208701610793565b601f01601f1916919091016040019291505056fe416464726573733a206c6f772d6c6576656c2064656c65676174652063616c6c206661696c6564a26469706673582212207d99328d964db0b592a69d8d8ee0d4db59ed2781193c5e52230752c6643090a464736f6c63430008140033b53127684a568b3173ae13b9f8a6016e243e63b6e8ee1178d6a717850b5d6103416464726573733a206c6f772d6c6576656c2064656c65676174652063616c6c206661696c65640000000000000000000000008dcc9123dfa96e522fd0b4e670d21bce86680253000000000000000000000000242dae44f5d8fb54b198d03a94da45b5a4413e2100000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000024c4d66de80000000000000000000000002a3dd3eb832af982ec71669e178424b10dca2ede00000000000000000000000000000000000000000000000000000000"
            );
            console.log("Proxy deployed!");
        } else {
            console.log("Proxy already deployed correctly!");
        }
        vm.stopBroadcast();

        require(expectedImpl.code.length != 0, "Implementation not deployed correctly!");
        require(expectedProxy.code.length != 0, "Proxy not deployed correctly!");
    }
}
